<script type="text/javascript" language="JavaScript">
  function checkForm(form)
  {
    if(!form.terms.checked) {
      alert("Pour continuer veuillez accepter les termes et conditions.");
      form.terms.focus();
      return false;
    }
    return true;
  }

  document.addEventListener("keyup", function(e){
    const emailReg = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
    const email = document.querySelector(".connection-input-1").value
    const box = document.querySelector(".connection-input-1")
    if(!emailReg.test(email)){
        box.classList.remove("connection-input-green")
        box.classList.add("connection-input-red")
    } else {
        box.classList.remove("connection-input-red")
        box.classList.add("connection-input-green")
    }
  });

  document.addEventListener("keyup", function(e){
    const nameReg = /^([a-zA-Z0-9_-]){3,25}$/;
    const name = document.querySelector(".connection-input-2").value
    const box = document.querySelector(".connection-input-2")
    if(!nameReg.test(name)){
        box.classList.remove("connection-input-green")
        box.classList.add("connection-input-red")
    } else {
        box.classList.remove("connection-input-red")
        box.classList.add("connection-input-green")
    }
  });

  document.addEventListener("keyup", function(e){
    const passwordReg = /^([a-zA-Z0-9_-]){6,20}$/;
    const password = document.querySelector(".connection-input-3").value
    const box = document.querySelector(".connection-input-3")
    if(!passwordReg.test(password)){
        box.classList.remove("connection-input-green")
        box.classList.add("connection-input-red")
    } else {
        box.classList.remove("connection-input-red")
        box.classList.add("connection-input-green")
    }
  });

  document.addEventListener("keyup", function(e){
    const password_1 = document.querySelector(".connection-input-3").value
    const password_2 = document.querySelector(".connection-input-4").value
    const box = document.querySelector(".connection-input-4")
    if(password_1 === password_2){
        box.classList.remove("connection-input-red")
        box.classList.add("connection-input-green")
    } else {
        box.classList.remove("connection-input-green")
        box.classList.add("connection-input-red")
    }
  });

</script>

<div id='sign-up-form'>
<h2>S'inscrire</h2>

  <form class="simple_form new_user" onsubmit="return checkForm(this);" id="new_user" novalidate="novalidate" action="/users" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>" >

    <div class="form-inputs">
      <div class="label">
        <label class="email optional" for="user_email">Email</label>
      </div>
      <div class="field">
        <input required="required" autofocus="autofocus" input_html="{:autocomplete=>&quot;email&quot;}" class="connection-input connection-input-1" type="text" value="" name="user[email]" id="user_email">
      </div>
      <div class="label">
        <label class="string optional" for="user_nom">Nom</label>
      </div>
      <div class="field">
        <input required="required" autofocus="autofocus" input_html="{:autocomplete=>&quot;nom&quot;}" class="connection-input connection-input-2" type="text" name="user[name]" id="user_name">
      </div>
      <div class="label">
        <label class="string optional" for="user_mot_de_passe">Mot de passe</label>
      </div>
      <div class="field">
        <input required="required" input_html="{:autocomplete=>&quot;new-password&quot;}" class="connection-input connection-input-3" type="password" name="user[password]" id="user_password">
      </div>
      <div class="label">
        <label class="string optional" for="user_mot_de_passe">Mot de passe</label>
      </div>
      <div class="field">
        <input required="required" input_html="{:autocomplete=>&quot;new-password&quot;}" class="connection-input connection-input-4" type="password" name="user[password]" id="user_password">
      </div>
      <div class="flex-div">
        <div class="checkbox-div">
          <input type="checkbox" name="terms" id="checkbox">
        </div>
        <div class="conditions-div">
          <p> En cochant cette case, je reconnais avoir pris connaissance des <%= link_to "Conditions Générales d'Utilisation", cgu_path %> du site ainsi que sa <%= link_to "Politique de Confidentialité", rgpd_path %> et je les accepte.</p>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <input type="submit" name="commit" value="Inscription" class="btn ajouter" id="submit_button">
    </div>
  </form>
<%= render "devise/shared/links" %>
</div>








